{"version":3,"sources":["webpack:///./src/views/Login.vue?a4e7","webpack:///src/views/Login.vue","webpack:///./src/views/Login.vue?66fe","webpack:///./src/views/Login.vue","webpack:///./src/views/Login.vue?b045"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","attrs","rules","loginForm","staticStyle","_v","leaveTab","model","value","callback","$$v","$set","expression","captcha","on","updateCaptcha","checked","clickLogin","goToRegisterPage","_m","staticRenderFns","name","data","phone","email","password","datetime","mounted","Date","getTime","$store","state","uid","gid","isAdmin","$router","push","computed","methods","activeName","$refs","validate","valid","token","localStorage","setItem","component"],"mappings":"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","file":"js/chunk-06db9ec0.20b91c25.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-form',{ref:\"loginForm\",staticClass:\"loginContainer\",attrs:{\"rules\":_vm.rules,\"model\":_vm.loginForm}},[_c('h3',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\"登录\")]),_c('el-tabs',{staticStyle:{\"height\":\"100px\"},attrs:{\"tab-position\":\"top\",\"stretch\":\"\",\"before-leave\":_vm.leaveTab}},[_c('el-tab-pane',{attrs:{\"label\":\"手机号登录\"}},[_c('el-form-item',{attrs:{\"prop\":\"phone\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入手机号\"},model:{value:(_vm.loginForm.phone),callback:function ($$v) {_vm.$set(_vm.loginForm, \"phone\", $$v)},expression:\"loginForm.phone\"}})],1)],1),_c('el-tab-pane',{attrs:{\"label\":\"邮箱登录\"}},[_c('el-form-item',{attrs:{\"prop\":\"email\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入邮箱\"},model:{value:(_vm.loginForm.email),callback:function ($$v) {_vm.$set(_vm.loginForm, \"email\", $$v)},expression:\"loginForm.email\"}})],1)],1)],1),_c('el-form-item',{attrs:{\"prop\":\"password\"}},[_c('el-input',{attrs:{\"show-password\":\"\",\"placeholder\":\"请输入密码\"},model:{value:(_vm.loginForm.password),callback:function ($$v) {_vm.$set(_vm.loginForm, \"password\", $$v)},expression:\"loginForm.password\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"captcha\"}},[_c('el-input',{staticStyle:{\"width\":\"60%\"},attrs:{\"tpye\":\"text\",\"placeholder\":\"点击图片更换验证码\"},model:{value:(_vm.loginForm.captcha),callback:function ($$v) {_vm.$set(_vm.loginForm, \"captcha\", $$v)},expression:\"loginForm.captcha\"}}),_c('img',{staticStyle:{\"float\":\"right\",\"cursor\":\"pointer\"},attrs:{\"src\":_vm.captcha,\"alt\":\"验证码\"},on:{\"click\":_vm.updateCaptcha}})],1),_c('el-form-item',{staticStyle:{\"margin-bottom\":\"0\"}},[_c('el-link',{staticClass:\"rememberMe\",attrs:{\"underline\":false}},[_c('el-checkbox',{model:{value:(_vm.checked),callback:function ($$v) {_vm.checked=$$v},expression:\"checked\"}},[_vm._v(\"保持登录\")])],1),_c('el-link',{staticClass:\"forgot\",attrs:{\"href\":\"https://zhangguapi.com\",\"target\":\"_blank\",\"underline\":false}},[_vm._v(\"忘记密码？\")])],1),_c('el-form-item',[_c('el-button',{staticStyle:{\"width\":\"48%\"},attrs:{\"type\":\"primary\",\"round\":\"\"},on:{\"click\":_vm.clickLogin}},[_vm._v(\"登录\")]),_c('el-button',{staticStyle:{\"width\":\"48%\",\"float\":\"right\"},attrs:{\"type\":\"success\",\"round\":\"\"},on:{\"click\":_vm.goToRegisterPage}},[_vm._v(\"注册\")])],1)],1),_vm._m(0)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"img\"},[_c('img',{attrs:{\"src\":\"https://i.loli.net/2019/04/23/5cbf0a3fe48e9.png\",\"alt\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <el-form :rules=\"rules\" ref=\"loginForm\" :model=\"loginForm\" class=\"loginContainer\">\n      <h3 style=\"text-align: center\">登录</h3>\n      <el-tabs tab-position=\"top\" style=\"height: 100px\" stretch :before-leave=\"leaveTab\">\n        <el-tab-pane label=\"手机号登录\">\n          <el-form-item prop=\"phone\">\n            <el-input v-model=\"loginForm.phone\" placeholder=\"请输入手机号\"></el-input>\n          </el-form-item>\n        </el-tab-pane>\n        <el-tab-pane label=\"邮箱登录\">\n          <el-form-item prop=\"email\">\n            <el-input v-model=\"loginForm.email\" placeholder=\"请输入邮箱\"></el-input>\n          </el-form-item>\n        </el-tab-pane>\n      </el-tabs>\n      <el-form-item prop=\"password\">\n        <el-input show-password v-model=\"loginForm.password\" placeholder=\"请输入密码\"></el-input>\n      </el-form-item>\n      <el-form-item prop=\"captcha\">\n        <el-input tpye=\"text\" v-model=\"loginForm.captcha\" placeholder=\"点击图片更换验证码\" style=\"width: 60%\"></el-input>\n        <img :src=\"captcha\" @click=\"updateCaptcha\" alt=\"验证码\"\n             style=\"float: right; cursor: pointer\"/>\n      </el-form-item>\n      <el-form-item style=\"margin-bottom: 0\">\n        <el-link :underline=\"false\" class=\"rememberMe\">\n          <el-checkbox v-model=\"checked\">保持登录</el-checkbox>\n        </el-link>\n        <el-link href=\"https://zhangguapi.com\" target=\"_blank\" :underline=\"false\" class=\"forgot\">忘记密码？</el-link>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" style=\"width: 48%\" @click=\"clickLogin\" round>登录</el-button>\n        <el-button type=\"success\" style=\"width: 48%; float: right\" @click=\"goToRegisterPage\" round>注册</el-button>\n      </el-form-item>\n    </el-form>\n    <div class=\"img\">\n      <img src=\"https://i.loli.net/2019/04/23/5cbf0a3fe48e9.png\" alt=\"\"/>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {postRequest} from \"@/utils/api\";\nimport {getUser} from \"@/utils/login\";\n\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      checked: true,\n      loginForm: {\n        phone: \"\",\n        email: \"\",\n        password: \"\",\n        datetime: \"\",\n        captcha: \"\",\n      },\n      rules: {\n        password: [{required: true, message: \"密码不能为空\", trigger: \"blur\"},],\n        captcha: [{required: true, message: \"验证码不能为空\", trigger: \"blur\"},],\n      },\n    };\n  },\n  mounted() {\n    // // 页面启动给datetime赋值时间戳\n    this.loginForm.datetime = new Date().getTime();\n    // // 判断是否存在登录信息\n    // console.log(this.$store.state)\n    if (this.$store.state.uid && this.$store.state.name && this.$store.state.gid && this.$store.state.isAdmin) {\n      this.$router.push(\"/\");\n    }\n  },\n  computed: {\n    captcha() {\n      return '/api/captcha?dateTime=' + this.loginForm.datetime;\n    }\n  },\n  methods: {\n    // 点击更换验证码（将来更换验证方式）\n    updateCaptcha() {\n      this.loginForm.datetime = new Date().getTime();\n    },\n    /**\n     * 根据tabs标签页返回相应的验证规则\n     * @param activeName 切换标签后的新值\n     */\n    leaveTab(activeName) {\n      // alert(activeName)\n      switch (activeName) {\n        case '0':\n          delete this.rules.email;\n          this.rules.phone = [{required: true, message: \"手机号不能为空\", trigger: \"blur\"},];\n          this.loginForm.phone = \"\";\n          break;\n        case '1':\n          delete this.rules.phone;\n          this.rules.email = [{required: true, message: \"邮箱不能为空\", trigger: \"blur\"},];\n          this.loginForm.email = \"\";\n          break;\n      }\n      this.loginForm.password = \"\";\n    },\n    //登录点击事件\n    clickLogin() {\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          postRequest(\"/login\", this.loginForm).then((res) => {\n            // console.log(res)\n            const token = res.data.data;\n            if (token){\n              if (this.checked) {\n                localStorage.setItem(\"token\", token)\n                if (getUser()) {\n                  this.$message.success(\"登录成功。\")\n                  if (this.$store.state.isAdmin){\n                    this.$router.push(\"/admin\")\n                  }else {\n                    this.$router.push(\"/\")\n                  }\n                } else {\n                  this.$message.error(res.data.msg)\n                  this.updateCaptcha();\n                }\n              }\n            } else {\n              this.$message.error(res.data.msg)\n              this.updateCaptcha();\n            }\n\n          }).catch((error) => {\n            // console.log(error)\n            this.updateCaptcha();\n          });\n        } else {\n          this.$message.error(\"请输入完整！\");\n        }\n      });\n    },\n    //跳转注册页面\n    goToRegisterPage() {\n      this.$router.push(\"/register\");\n    }\n  },\n};\n</script>\n<style lang=\"less\" scoped>\n.loginContainer {\n  border-radius: 15px;\n  background-clip: padding-box;\n  margin: 180px auto;\n  width: 350px;\n  padding: 15px 35px;\n  background: #fff;\n  border: 1px solid #eeeeee;\n  box-shadow: 0 0 25px #cac6c6;\n}\n\n.rememberMe {\n  margin: 0 0 10px 0;\n}\n\n.forgot {\n  float: right;\n  margin: 0 0 10px 0;\n}\n\n.el-tabs {\n  margin-bottom: 22px;\n}\n\n.img {\n  margin-top: -150px;\n  text-align: center;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=047cd6ce&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=047cd6ce&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"047cd6ce\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Login.vue?vue&type=style&index=0&id=047cd6ce&lang=less&scoped=true&\""],"sourceRoot":""}